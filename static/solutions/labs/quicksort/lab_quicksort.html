<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="generator" content="pandoc" />
  <title></title>
  <style type="text/css">
/*<![CDATA[*/
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode, table.sourceCode pre 
   { margin: 0; padding: 0; border: 0; vertical-align: baseline; border: none; }
td.lineNumbers { border-right: 1px solid #AAAAAA; text-align: right; color: #AAAAAA; padding-right: 5px; padding-left: 5px; }
td.sourceCode { padding-left: 5px; }
code.sourceCode span.kw { color: #007020; font-weight: bold; } 
code.sourceCode span.dt { color: #902000; }
code.sourceCode span.dv { color: #40a070; }
code.sourceCode span.bn { color: #40a070; }
code.sourceCode span.fl { color: #40a070; }
code.sourceCode span.ch { color: #4070a0; }
code.sourceCode span.st { color: #4070a0; }
code.sourceCode span.co { color: #60a0b0; font-style: italic; }
code.sourceCode span.ot { color: #007020; }
code.sourceCode span.al { color: red; font-weight: bold; }
code.sourceCode span.fu { color: #06287e; }
code.sourceCode span.re { }
code.sourceCode span.er { color: red; font-weight: bold; }
/*]]>*/
  </style>
</head>
<body>
<!-- <script type="text/javascript" -->
<!--   src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"> -->
<!-- </script> -->

<script type="text/javascript"
  src="https://c328740.ssl.cf1.rackcdn.com/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
});
</script>

<link rel="stylesheet" href="http://www.cs.dartmouth.edu/~cs1/azul.css" type="text/css" />


<div id = "menubar">
<ul>
<li><a href="http://www.cs.dartmouth.edu/~cs1/syllabus.html">Syllabus</a>
<li><a href="http://www.cs.dartmouth.edu/~cs1/schedule.html">Schedule</a>
<li><a href="http://www.cs.dartmouth.edu/~cs1/shortassign/short_assignments.html">Short assignments</a>
<li><a href="http://www.cs.dartmouth.edu/~cs1/labs/lab_assignments.html">Labs</a>
<li><a href="http://www.cs.dartmouth.edu/~cs1/exams.html">Exams</a>
<li><a href="http://www.cs.dartmouth.edu/~cs1/software.html">Course software</a>
</ul>
</div>

<div id = "termtitle"> CS 1: Spring 2014 </div> 
<h1>Lab Assignment 3: Sorting it all out <br />Due: Friday, May 16 at 1:45 pm <br />Checkpoint due: Monday, May 12 at 1:45 pm</h1>
<p>Computer science is about a lot more than handling data, but computers are still a very useful tool for working with large amounts of data. Scientific experiments in biology, chemistry, physics, and psychology can generate huge numbers of measurements. In economics, business, or politics, data can be generated by everything from stock prices, to poll results, to voting records of congressmen. In this lab, you'll read data from a file, how to organize that data using a class, how to write an algorithm to manipulate the data, and how to visualize your result.</p>
<p>Several sorting algorithms have been presented to you: insertion sort, selection sort, and merge sort. One part of this assignment will ask you to implement quicksort. Quicksort has a worst-case running time of <span class="math"><em>O</em>(<em>n</em><sup>2</sup>)</span> (worse than merge sort), but the worst case for quicksort occurs rarelyâ€”rarely enough that on average, it runs in <span class="math"><em>O</em>(<em>n</em> log<sub>2</sub> <em>n</em>)</span> time. Quicksort has two advantages over merge sort: the constants are better, and quicksort runs &quot;in place&quot;: no temporary lists have to be created, and so very little additional memory is required to quicksort. (Side note: although I've said that constant factors hidden in big-Oh notation do not usually matter, if two algorithms have similar running times when expressed in big-Oh notation, it is nice to use the algorithm with the smaller constants.)</p>
<p>Now, you might ask why you need to implement quicksort when Python has a sorting method built in and when you've already learned three other sorting algorithms. That's a fair question, but if the professors who taught the Python designers had let them skip sorting, we wouldn't have such a nice built-in sort function in Python. I won't let you skip learning how to sort, either!</p>
<p>In this lab assignment, you will read in a text file in which each line describes a world city, store the information about each city in its own object within a list, sort the list using quicksort, write the results out to a file, and display part of the output file in a visualization on a world map.</p>
<h2 id="checkpoint-file-input-and-output">Checkpoint: File input and output</h2>
<p>For the checkpoint you just need to read in the file of world city information, store the information about each city into its own <code>City</code> object within a list, and write out each object (converted to a string) to a file. You don't need to sort anything, and you don't need to do the graphics.</p>
<h3 id="checkpoint-step-1-define-a-city-class">Checkpoint step 1: Define a <code>City</code> class</h3>
<p>Your first job in the checkpoint is to define a <code>City</code> class in a file named city.py. Each <code>City</code> object will need instance variables to store the following information:</p>
<ul>
<li>The city's country code, which is a two-letter string.</li>
<li>The city's name, which is a string.</li>
<li>The city's region, a two-character string.</li>
<li>The city's population, which is an int.</li>
<li>The city's latitude, which is a float.</li>
<li>The city's longitude, which is also a float.</li>
</ul>
<p>You need to write only two methods in the <code>City</code> class. The <code>__init__</code> method does the usual: it takes six parameters (plus <code>self</code>) and stores each in the appropriate instance variable. The <code>__str__</code> method returns a string consisting of the city's name, population, latitude, and longitude, separated by commas and with no spaces around the commas. For example, here's the string that <code>__str__</code> should return for a particular town in New Hampshire:</p>
<pre><code>Hanover,11222,43.7022222,-72.29
</code></pre>
<p>Notice that the country code and region do <em>not</em> appear in the string returned by <code>__str__</code>.</p>
<h3 id="checkpoint-step-2-read-in-and-parse-the-input-file">Checkpoint step 2: Read in and parse the input file</h3>
<p>The input file is in <a href="world_cities.txt">world_cities.txt</a>. Download this file, and drag it into your Eclipse project. This file has 47913 lines. Each line has information about a world city, specifically the six attributes you'll store in the <code>City</code> object, but of course represented textually. These attributes are separated by commas without surrounding spaces. We call such a file a <em>CSV file</em>. (CSV is short for &quot;comma-separated values.&quot;) Here's the line of the world_cities.txt file for that town in New Hampshire:</p>
<pre><code>us,Hanover,NH,11222,43.7022222,-72.2900000
</code></pre>
<p>You already know how to read in a file, line by line. But if you forgot, see the notes from <a href="../../lectures/lecture08/lecture08.html">Lecture 8</a>. But how can you process this line? Python makes it pretty easy.</p>
<p>To separate text at a particular delimiter character, call the <code>split</code> method on the string. It returns a list of the strings that, concatenated with the delimiter added in, gives you back the string. This idea is best shown by an example:</p>
<pre class="sourceCode"><code class="sourceCode python">s = <span class="st">&quot;a man, a plan, a canal,&quot;</span><br />clauses = s.split(<span class="st">&quot;,&quot;</span>)<br /><span class="kw">print</span> clauses</code></pre>
<p>prints</p>
<pre><code>['a man', ' a plan', ' a canal', '']
</code></pre>
<p>Note that every character other than the commas becomes part of one of the strings in the list. Not only do the spaces after the first two commas become part of strings in the list, but we also get an empty string at the end. Why? Because the string <code>s</code> ends with a comma, and so the <code>split</code> method gives back the empty string after the comma.</p>
<p>You can use any character as the delimiter, and the default is a space character. More examples:</p>
<pre class="sourceCode"><code class="sourceCode python">s = <span class="st">&quot;Roll out the barrel&quot;</span><br />words = s.split()<br /><span class="kw">print</span> words</code></pre>
<p>prints</p>
<pre><code>['Roll', 'out', 'the', 'barrel']
</code></pre>
<p>And</p>
<pre class="sourceCode"><code class="sourceCode python">s = <span class="st">&quot;commander--in-chief&quot;</span><br />parts = s.split(<span class="st">&quot;-&quot;</span>)<br /><span class="kw">print</span> parts</code></pre>
<p>(there are two hyphens between <em>commander</em> and <em>in</em>) prints</p>
<pre><code>['commander', '', 'in', 'chief']
</code></pre>
<p>Again, note the empty string caused by two delimiters in a row.</p>
<p>To strip away whitespace from the beginning and end of a string, call the <code>strip</code> method on the string:</p>
<pre class="sourceCode"><code class="sourceCode python">s = <span class="st">&quot;  The thousand injuries of Fortunato I had borne as best I could, </span><span class="ch">\n</span><span class="st">&quot;</span><br />t = <span class="st">&quot;|&quot;</span> + s.strip() + <span class="st">&quot;|&quot;</span><br /><span class="kw">print</span> t</code></pre>
<p>prints</p>
<pre><code>|The thousand injuries of Fortunato I had borne as best I could,|
</code></pre>
<p>I put the vertical bar characters in so that you could see where the string returned by the call <code>s.strip()</code> begins and ends.</p>
<p>Although each line of world_cities.txt begins with a non-whitespace character, each line ends with a newline, and newline is a whitespace character. Therefore, you will want to call <code>strip</code> on each line of the file and then call <code>split</code> to separate the information by the commas.</p>
<p>Once you have a list of information in a particular line of the file, you can send that information into the <code>City</code> constructor. Since <code>split</code> gives you a list, you can just index into that list for each item. Remember that some of the instance variables in a <code>City</code> object are <em>not</em> strings, and so you will have to convert these strings to the appropriate types.</p>
<p>The <code>City</code> constructor will give you back, as you undoubtedly know, a rrrrreference to a <code>City</code> object. You should append that reference to a list that you're building up. When you're done, the list should comprise 47913 references to <code>City</code> objects, one for each line in world_cities.txt.</p>
<h3 id="checkpoint-step-3-write-the-output-file">Checkpoint step 3: Write the output file</h3>
<p>Once you have the list of references to <code>City</code> objects and you have the <code>__str__</code> method of the <code>City</code> class defined, all you need to do now is create a file named cities_out.txt and write one line to it for each <code>City</code> object. The line for each city should contain the string returned by calling <code>str</code> on the corresponding <code>City</code> object. Because the <code>__str__</code> method inserts commas, cities_out.txt will be a CSV file. You'll need to add the newline for each city. When you're done, your cities_out.txt file should have 47913 lines. The first five and last five lines of cities_out.txt should be</p>
<pre><code>Andorra La Vella,20430,42.5,1.5166667
Canillo,3292,42.5666667,1.6
Encamp,11224,42.5333333,1.5833333
La Massana,7211,42.55,1.5166667
Les Escaldes,15854,42.5,1.5333333
...
Redcliffe,38231,-19.0333333,29.7833333
Rusape,23761,-18.5333333,32.1166667
Shurugwi,17107,-19.6666667,30.0
Victoria Falls,36702,-17.9333333,25.8333333
Zvishavane,79876,-20.3333333,30.0333333
</code></pre>
<p>Because the format of this file is tightly constrained, and because you'll be creating the file from world_cities.txt, your section leader has an automated tool to check that your cities_out.txt file is correct. It should match a file that your section leader has, in every single byte.</p>
<p><strong>For the checkpoint, submit your code and your cities_out.txt file.</strong></p>
<h2 id="quicksort">Quicksort</h2>
<p>Once you have done the checkpoint, you will need to sort the list of <code>City</code> objects according to various criteria. You will use the quicksort algorithm to sort.</p>
<p>Like merge sort, quicksort uses the paradigm of divide-and-conquer, and hence it's recursive. As in merge sort, the problem is to sort a sublist <code>the_list[p : r+1]</code>, which consists of the items starting at <code>the_list[p]</code> and going through <code>the_list[r]</code>. (Recall again that in Python's slice notation, the number after the colon is the index of the first item <em>not</em> in the sublist.) Initially, <code>p</code> equals 0 and <code>r</code> equals <code>len(the_list)-1</code>, but these values will change through the recursive calls.</p>
<ul>
<li><p><strong>Divide:</strong> Choose any item within the sublist <code>the_list[p : r+1]</code>. Store this item in a variable named <code>pivot</code>. <strong>Partition</strong> <code>the_list[p : r+1]</code> into two sublists <code>the_list[p:q]</code> and <code>the_list[q+l : r+1]</code> (note that <code>the_list[q]</code> is in neither of these sublists) with the following properties:</p>
<ol style="list-style-type: decimal">
<li>Each item in <code>the_list[p:q]</code> (the items in positions <span class="math"><em>p</em></span> through <span class="math"><em>q</em>â€…-â€…1</span>) is less than or equal to the value of <code>pivot</code>.</li>
<li>The value of <code>pivot</code> is in <code>the_list[q]</code>.</li>
<li>Each item in <code>the_list[q+1 : r+1]</code> (the items in positions <span class="math"><em>q</em>â€…+â€…1</span> through <span class="math"><em>r</em></span>) is greater than the value of <code>pivot</code>.</li>
</ol></li>
<li><p><strong>Conquer</strong>: Recursively sort the two sublists <code>the_list[p:q]</code> and <code>the_list[q+l : r+1]</code>.</p></li>
<li><p><strong>Combine</strong>: Do nothing! The recursive step leaves the entire sublist <code>the_list[p : r+1]</code> sorted. Why? Because the sublists <code>the_list[p:q]</code> and <code>the_list[q+l : r+1]</code> are each sorted, each item in <code>the_list[p:q]</code> is at most the value of <code>pivot</code>, which is in <code>the_list[q]</code>, and each item in <code>the_list[q+1 : r+1]</code> is greater than <code>pivot</code>. The sublist <code>the_list[p : r+1]</code> can't help but be sorted!</p></li>
</ul>
<p>The base case is the same as for merge sort: a sublist with fewer than two items is already sorted.</p>
<h3 id="partitioning">Partitioning</h3>
<p>It doesn't take much thought to see that all the work in quicksort occurs in the partitioning step, so let's see how to do that. You will write a function with the following header:</p>
<pre class="sourceCode"><code class="sourceCode python"><span class="kw">def</span> partition(the_list, p, r, compare_func):</code></pre>
<p>This function should partition the sublist <code>the_list[p : r+1]</code>, and it should return an index <code>q</code> into the list, which is where it places the item chosen as the pivot. As a running example, we'll suppose that the current sublist to be sorted is <code>[2, 8, 7, 1, 3, 5, 6, 4]</code>, so that <code>the_list[p]</code> contains 2 and <code>the_list[r]</code> contains 4.</p>
<p>First, we need to select an item as <code>pivot</code>. Let's always select the last item in the sublist, that is, <code>the_list[r]</code>. In our example, we select 4 as the value of <code>pivot</code>. When we're done partitioning, we could have any of several results. Here are three of them:</p>
<pre><code>[3, 2, 1, 4, 7, 8, 6, 5]
[1, 3, 2, 4, 8, 7, 5, 6]
[2, 1, 3, 4, 6, 8, 5, 7]
</code></pre>
<p>Several more are possible, but what matters is that 4 is in the position it would be in if the sublist were sorted, all items before 4 are less than or equal to 4, and all items after 4 are greater than 4.</p>
<p>We want to partition the sublist <em>efficiently</em>. (Remember that we're in the part of the course where not only do we want right answers, but we want to use resourcesâ€”especially timeâ€”parsimoniously.) If the sublist contains <span class="math"><em>n</em></span> items, we might have to move each one, and so <span class="math"><em>O</em>(<em>n</em>)</span> time for partitioning an <span class="math"><em>n</em></span>-item sublist is the best we can hope for. Indeed, we can achieve <span class="math"><em>O</em>(<em>n</em>)</span> time. This picture gives you an idea of how:</p>
<div class="figure">
<img src="partition-example.png" /><p class="caption"></p>
</div>
<p>You can also look at <a href="Partition.ppt">this PowerPoint</a>.</p>
<p>The idea is to loop through the items in <code>the_list[p:r]</code> (which does not include <code>the_list[r]</code>, the value of <code>pivot</code>.) Maintain two indices, <span class="math"><em>i</em></span> and <span class="math"><em>j</em></span>, into the sublist:</p>
<div class="figure">
<img src="partition-structure.png" /><p class="caption"></p>
</div>
<p>At the start of each loop iteration, for any index <span class="math"><em>k</em></span> into the sublist:</p>
<ol style="list-style-type: decimal">
<li>If <span class="math"><em>p</em>â€„â‰¤â€„<em>k</em>â€„â‰¤â€„<em>i</em></span>, then <code>the_list[k]</code> <span class="math">â€„â‰¤â€„</span> <code>pivot</code>.</li>
<li>If <span class="math"><em>i</em>â€…+â€…1â€„â‰¤â€„<em>k</em>â€„â‰¤â€„<em>j</em>â€…-â€…1</span>, then <code>the_list[k]</code> &gt; <code>pivot</code>.</li>
<li>If <span class="math"><em>j</em>â€„â‰¤â€„<em>k</em>â€„â‰¤â€„<em>r</em>â€…-â€…1</span>, then we have yet to compare <code>the_list[k]</code> with <code>pivot</code>, and so we don't yet know which is greater.</li>
<li>If <span class="math"><em>k</em>â€„=â€„<em>r</em></span>, then <code>the_list[k]</code> equals <code>pivot</code>.</li>
</ol>
<p>Start with <span class="math"><em>i</em>â€„=â€„<em>p</em>â€…-â€…1</span> and <span class="math"><em>j</em>â€„=â€„<em>p</em></span>. There are no indices between <span class="math"><em>p</em></span> and <span class="math"><em>i</em></span>, and there are no indices between <span class="math"><em>i</em>â€…+â€…1</span> and <span class="math"><em>j</em>â€…-â€…1</span>, and so the above conditions must hold: all indices <span class="math"><em>k</em></span> between <span class="math"><em>j</em></span> and <span class="math"><em>r</em>â€…-â€…1</span> have yet to be compared with <code>pivot</code>. Set <code>pivot = the_list[r]</code> to satisfy the last condition.</p>
<p>Each iteration of the loop finds one of two possibilities:</p>
<ul>
<li><p><code>the_list[j]</code> &gt; <code>pivot</code>:</p>
<div class="figure">
<img src="partition-one-step-gt.png" /><p class="caption"></p>
</div>
<p>All you need to do is increment <span class="math"><em>j</em></span>. Afterward, condition 2 holds for <code>the_list[j-1]</code>, and all other items remain unchanged.</p></li>
<li><p><code>the_list[j]</code> â‰¤ <code>pivot</code>:</p>
<div class="figure">
<img src="partition-one-step-le.png" /><p class="caption"></p>
</div>
<p>In this case, you need to increment <span class="math"><em>i</em></span>, swap the values in <code>the_list[i]</code> and <code>the_list[j]</code>, and then increment <span class="math"><em>j</em></span>. Because of the swap, we now have that <code>the_list[i]</code> â‰¤ <code>pivot</code>, and condition 1 is satisfied. Similarly, we also have that <code>the_list[j-1]</code> &gt; <code>pivot</code>, since the item that was swapped into <code>the_list[j-1]</code> is, by condition 2, greater than <code>pivot</code>.</p></li>
</ul>
<p>The loop should terminate immediately upon <span class="math"><em>j</em></span> equaling <span class="math"><em>r</em></span>. To be clear: the last time that the loop body should execute is for <span class="math"><em>j</em>â€„=â€„<em>r</em>â€…-â€…1</span>. The loop body should <em>not</em> execute when <span class="math"><em>j</em>â€„=â€„<em>r</em></span>.</p>
<p>Once <span class="math"><em>j</em></span> equals <span class="math"><em>r</em></span>, every sublist item before <code>the_list[r]</code> has been compared with <code>pivot</code> and is in the right place. All that remains is to put the pivot, currently in <code>the_list[r]</code> into the right place. Do so by swapping it with the item in <code>the_list[i+1]</code>, which is the leftmost item in the partition known to be greater than <code>pivot</code>. (If the greater-than partition happens to be empty, then this swap should just swap <code>the_list[r]</code> with itself, which is fine in this case.)</p>
<p>Your <code>partition</code> function should return to its caller the <em>index</em> <code>q</code> where it has placed <code>pivot</code>.</p>
<p>The function <code>compare_func</code> will be one that you write and pass in. It takes two parameters, say <code>a</code> and <code>b</code>, and it returns <code>True</code> if <code>a</code> compares as less than or equal to <code>b</code>, and it returns <code>False</code> if <code>a</code> compares as greater than <code>b</code>. For example, the call <code>compare_func(3, 5)</code> should return <code>True</code>, the call <code>compare_func(7, 5)</code> should return <code>False</code>, the call <code>compare_func(5, 5)</code>, should return <code>True</code>, the call <code>compare_func(&quot;Tallahassee&quot;, &quot;Tokyo&quot;)</code> should return <code>True</code>, and the call <code>compare_func(&quot;Boise&quot;, &quot;Bismarck&quot;)</code> should return <code>False</code>. Your <code>partition</code> function should call <code>compare_func</code> to compare each sublist item with <code>pivot</code>.</p>
<p>You have not written your own functions that take a function as a parameter, so let's see how easy it is to do so. Here's an example:</p>
<pre class="sourceCode"><code class="sourceCode python"><span class="ch">from</span> string <span class="ch">import</span> lower<br /><br /><span class="kw">def</span> do_it(compare_func, x, y):<br />    <span class="kw">if</span> compare_func(x, y):<br />        <span class="kw">print</span> x, <span class="st">&quot;is less than&quot;</span>, y<br />    <span class="kw">else</span>:<br />        <span class="kw">print</span> x, <span class="st">&quot;is not less than&quot;</span>, y<br /><br /><span class="kw">def</span> compare_ints(a, b):<br />    <span class="kw">return</span> a &lt; b<br /><br /><span class="kw">def</span> compare_strings(a, b):<br />    <span class="kw">return</span> lower(a) &lt; lower(b)<br /><br />do_it(compare_ints, <span class="dv">5</span>, <span class="dv">7</span>)<br />do_it(compare_strings, <span class="st">&quot;Dartmouth&quot;</span>, <span class="st">&quot;Cornell&quot;</span>)</code></pre>
<p>The call <code>do_it(compare_ints, 5, 7)</code> passes the function <code>compare_ints</code> into <code>do_it</code> as the first parameter, and so in <code>do_it</code>, <code>compare_func</code> is really <code>compare_ints</code>. The other formal parameters of <code>do_it</code> are <code>x</code> and <code>y</code>, and they get the values 5 and 7, respectively. Therefore, the call <code>compare_func(x, y)</code> is really the call <code>compare_ints(5, 7)</code>. This call returns <code>True</code> (the parameter <code>a</code> gets the value 5, and the parameter <code>b</code> gets the value 7), and so the line <code>5 is less than 7</code> is printed to the console. Next, the call <code>do_it(compare_strings, &quot;Dartmouth&quot;, &quot;Cornell&quot;)</code> passes the function <code>compare_strings</code> as the first parameter, and now in <code>do_it</code>, <code>compare_func</code> is really <code>compare_strings</code>. The formal parameter <code>x</code> references the string <code>&quot;Dartmouth&quot;</code>, and the formal parameter <code>y</code> references the string <code>&quot;Cornell&quot;</code>, so now when we call <code>compare_func(x, y)</code>, we're really calling <code>compare_strings(&quot;Dartmouth&quot;, &quot;Cornell&quot;)</code>. The function <code>compare_strings</code> first makes copies of its parameters, but converted to lowercase (that's what the function <code>lower</code>, imported from the <code>strings</code> module, does), and then it compares them lexically, using the ASCII character codes. Because <code>&quot;dartmouth&quot;</code> comes <em>after</em> <code>&quot;cornell&quot;</code> lexically, <code>compare_strings</code> returns <code>False</code>, and so the console output is now <code>Dartmouth is not less than Cornell</code> (which is true, because as we all know, Dartmouth is greater than Cornell).</p>
<p>You should implement and test your <code>partition</code> function before writing any other code. Make sure that it works on an arbitrary sublist of <code>the_list</code>, and not just the sublist where <span class="math"><em>p</em>â€„=â€„0</span> and $r = $ <code>len(the_list)-1</code>. You'll have to write the <code>compare_func</code> function as well, and design it so that it works on whatever data type <code>the_list</code> contains. You should certainly test <code>partition</code> on lists containing numbers and on lists containing strings.</p>
<p>I was able to write the body of the <code>partition</code> function in 10 lines of Python code (not counting comment lines). I wrote a separate function to swap items in the sublist; the calls of this function count toward the 10 lines but the body of the swap function does not.</p>
<h3 id="the-quicksort-function">The <code>quicksort</code> function</h3>
<p>Once you have the <code>partition</code> function written and tested, you should write a function with the header</p>
<pre class="sourceCode"><code class="sourceCode python"><span class="kw">def</span> quicksort(the_list, p, r, compare_func):</code></pre>
<p>which sorts the sublist <code>the_list[p : r+1]</code>, whose first item is in <code>the_list[p]</code> and whose last item is in <code>the_list[r]</code>.</p>
<p>It should work as described above:</p>
<ul>
<li><p>The base case occurs when the sublist has fewer than two items. Nothing needs to be done.</p></li>
<li><p>Otherwise, call the <code>partition</code> function to partition the sublist. The call will return an index <code>q</code>, indicating that it has placed the pivot item in <code>the_list[q]</code>.</p></li>
<li><p>Recursively call <code>quicksort</code> on the sublist starting at index <code>p</code> and going up to, <em>but not including</em>, index <code>q</code>. Recursively call <code>quicksort</code> on the sublist starting at the index just past <code>q</code> and going up to <em>and including</em> index <code>r</code>.</p></li>
</ul>
<p>The body of my <code>quicksort</code> function takes only 4 lines of Python, not counting comment lines.</p>
<h3 id="the-sort-function">The <code>sort</code> function</h3>
<p>Unlike the examples from lecture, you'll write a separate function named <code>sort</code> in this lab assignment. It has this header:</p>
<pre class="sourceCode"><code class="sourceCode python"><span class="kw">def</span> sort(the_list, compare_func):</code></pre>
<p>It simply makes a call to the <code>quicksort</code> function to sort the entire list referenced by <code>the_list</code>.</p>
<p><strong>Place the <code>partition</code>, <code>quicksort</code>, and <code>sort</code> functions in a single file named quicksort.py. Include in this file any other functions that your quicksort code calls, but not the comparison functions described below.</strong></p>
<h2 id="what-to-sort">What to sort</h2>
<p>You will sort information contained in <a href="world_cities.txt">world_cities.txt</a>.</p>
<p>Produce three output files:</p>
<ol style="list-style-type: decimal">
<li>cities_alpha.txt contains the list of cities sorted alphabetically.</li>
<li>cities_population.txt contains the list of cities sorted by population, from most to least populous.</li>
<li>cities_latitude.txt contains the list of cities sorted by latitude, from south to north.</li>
</ol>
<p>Here are the first and last few lines of each of the files, when I ran my program:</p>
<ol style="list-style-type: decimal">
<li><p>For cities_alpha.txt:</p>
<pre><code>A,1145,63.966667,10.2
A,1145,63.966667,10.216667
A Coruna,236010,43.366667,-8.383333
A Dos Cunhados,6594,39.15,-9.3
Aabenraa,16344,55.033333,9.433333
Aabybro,4849,57.15,9.75
Aachen,251104,50.770833,6.105278
Aadorf,7100,47.483333,8.9
Aakirkeby,2195,55.066667,14.933333
Aakre,295,58.1013889,26.1944444
...
Zychlin,8844,52.25,19.616667
Zykovo,1059,54.0666667,45.1
Zykovo,5365,55.9519444,93.1461111
Zyrardow,41179,52.066667,20.433333
Zyryanka,3627,65.75,150.85
Zyryanovsk,44939,49.738611,84.271944
Zyryanovskiy,896,57.7333333,61.7
Zyryanskoye,6285,56.8333333,86.6222222
Zyukayka,4556,58.2025,54.7002778
Zyuzelskiy,1311,56.4852778,60.1316667
</code></pre></li>
<li><p>For cities_population.txt:</p>
<pre><code>Tokyo,31480498,35.685,139.7513889
Shanghai,14608512,31.005,121.4086111
Bombay,12692717,18.975,72.825833
Karachi,11627378,24.866667,67.05
New Delhi,10928270,28.6,77.2
Delhi,10928270,28.666667,77.216667
Manila,10443877,14.604167,120.982222
Moscow,10381288,55.7522222,37.6155556
Seoul,10323448,37.5663889,126.9997222
Sao Paulo,10021437,-23.533333,-46.616667
...
Girsterklaus,12,49.7777778,6.4994444
Vstrechnyy,12,67.95,165.6
Qallimiut,12,60.7,-45.3333333
Skaelingur,11,62.1,-7.0
Ivittuut,11,61.2,-48.1666667
Crendal,10,50.0577778,5.8980556
El Porvenir,10,9.5652778,-78.9533333
Schleif,8,49.9905556,5.8575
Aliskerovo,7,67.7666667,167.5833333
Neriunaq,7,64.4666667,-50.3166667
Tasiusaq,7,73.3666667,-56.05
Timerliit,7,65.8333333,-53.25
</code></pre></li>
<li><p>For cities_latitude.txt:</p>
<pre><code>Ushuaia,58045,-54.8,-68.3
Punta Arenas,117432,-53.15,-70.9166667
Rio Gallegos,93234,-51.6333333,-69.2166667
Port-Aux-Francais,45,-49.35,70.2166667
Bluff,1938,-46.6,168.333333
Owaka,395,-46.45,169.666667
Invercargill,47287,-46.4,168.35
Woodlands,285,-46.366667,168.55
Riverton,1651,-46.35,168.016667
Wyndham,586,-46.333333,168.85
Wallacetown,638,-46.333333,168.266667
...
Kullorsuaq,408,74.5833333,-57.2
Savissivik,82,76.0233333,-65.0813889
Moriusaq,21,76.7561111,-69.8863889
Narsaq,1709,77.3025,-68.8425
Qaanaaq,616,77.4894444,-69.3322222
Qeqertat,18,77.5097222,-66.6477778
Siorapaluk,75,77.7952778,-70.7558333
Barentsburg,576,78.0666667,14.2333333
Longyearbyen,1232,78.2166667,15.6333333
Ny-Alesund,40,78.9333333,11.95
</code></pre></li>
</ol>
<p>Some things you should note:</p>
<ul>
<li><p>Whatever function you use as your comparison function should take as parameters references to two <code>City</code> objects. The comparison function will need to access the appropriate instance variables for the comparison.</p></li>
<li><p>When comparing city names, watch out for lowercase and uppercase letters. All uppercase letters compare as less than all lowercase letters: <code>&quot;a&quot; &lt; &quot;Z&quot;</code> evaluates to <code>False</code>. The function you use to compare city names should convert each name to either all lowercase (use the <code>lower</code> function from the <code>strings</code> module) or all uppercase (use the <code>upper</code> function from the <code>strings</code> module) before comparing. (Choose one: either all lowercase or all uppercase.) But this conversion should be <em>only</em> for the purpose of comparison. Do <em>not</em> change the city name as stored in a <code>City</code> object. Change it <em>only</em> within the comparison function.</p></li>
<li><p>When sorting by population, you want the <em>most</em> populous cities at the beginning of the output file. I can think of three ways to accomplish this goal. Let's assume that you have a function <code>compare_population(city1, city2)</code>.</p>
<ol style="list-style-type: decimal">
<li><p><code>compare_population(city1, city2)</code> returns <code>True</code> if the population of the <code>City</code> object referenced by <code>city1</code> is less than or equal to the population of the <code>City</code> object referenced by <code>city2</code>, and the resulting list is reversed before writing it out to a file.</p></li>
<li><p><code>compare_population(city1, city2)</code> returns <code>True</code> if the population of the <code>City</code> object referenced by <code>city1</code> is less than or equal to the population of the <code>City</code> object referenced by <code>city2</code>, and the resulting list is written out to a file starting from the back end.</p></li>
<li><p><code>compare_population(city1, city2)</code> returns <code>False</code> if the population of the <code>City</code> object referenced by <code>city1</code> is less than or equal to the population of the <code>City</code> object referenced by <code>city2</code>, and so the resulting list has the most populous cities first and is written out in order to a file.</p></li>
</ol></li>
</ul>
<p>Which choice do you think is the easiest to implement?</p>
<p><strong>Write the Python code that reads in the city information, sorts it, and writes out the result, along with <em>all</em> of your comparison functions, in a single file named sort_cities.py.</strong></p>
<h2 id="visualizing-the-output">Visualizing the output</h2>
<p>CSV files are just fine for computers, but not necessarily wetware-friendly. You will write a program that visualizes the output of your sorted cities.</p>
<p>Your program will display the image file <a href="world.png">world.png</a>:</p>
<div class="figure">
<img src="world.png" /><p class="caption"></p>
</div>
<p>Download this image file, and put it into your project in Eclipse. Your program will overlay the image with marks for the first <span class="math"><em>n</em></span> cities in an output file. For example, here's what it looks like with small orange squares for the 30 most populous cities:</p>
<div class="figure">
<img src="30-largest-cities.png" /><p class="caption"></p>
</div>
<p>It's easy to display this image file in a graphics window. After the window has been opened, all you need to do is</p>
<pre class="sourceCode"><code class="sourceCode python">img = load_image(<span class="st">&quot;world.png&quot;</span>)<br />draw_image(img, <span class="dv">0</span>, <span class="dv">0</span>)</code></pre>
<p>The first parameter to <code>draw_image</code> is the reference to an object for the image returned by <code>load_image</code>. (I don't know what kind of object this is, nor do I care. Yay, abstraction!) The second and third parameters give the <span class="math"><em>x</em></span>- and <span class="math"><em>y</em></span>-coordinates of the upper left corner of the image in the graphics window. If you are going to draw the image repeatedly, you may call <code>load_image</code> just once and call <code>draw_image</code> multiple times, as long as you have saved the reference returned by <code>load_image</code>.</p>
<p>I selected the world.png file specially because it uses linear scales for both latitude and longitude, and the (0, 0) spot is exactly in the middle of the image. This image is 720 pixels wide and 360 pixels high.</p>
<p>A hint for you: latitudes increase from south (bottom of the image) to north (top of the image). You just might find that fifth parameter to <code>start_graphics</code> to be of use.</p>
<p>But it's not enough to just show a static image with marks for the first <span class="math"><em>n</em></span> cities in some order. You need to show them dynamically, in an animation. For example, here's how I show the 30 most populous cities:</p>
<iframe width="560" height="315" src="http://www.youtube.com/embed/mbCUtLy6Zjo" frameborder="0" allowfullscreen></iframe>

<p>You don't have to show the city names, nor do you have to blink the marks for the cities. You may choose how you animate the cities. <strong>Show the <em>50</em> most populous cities, in order, starting from the most populous.</strong> (I've shown you the first 30.)</p>
<p><strong>Write your visualization code in a file named visualize_cities.py.</strong></p>
<h2 id="miscellaneous-reminder">Miscellaneous reminder</h2>
<p>Remember to close all files that you open once you're done reading from them or writing to them.</p>
<h2 id="grading">Grading</h2>
<p>Checkpoint: 5 points. 3 of the 5 points are for correct behavior and testing, and the remaining 2 points are for implementation and style.</p>
<p>The remaining 35 points are for the final version.</p>
<p>Correctness: 28 points</p>
<ul>
<li><code>partition</code> function: 7 points</li>
<li><code>quicksort</code> and <code>sort</code> functions: 6 points</li>
<li>comparison functions: 2 points</li>
<li><code>City</code> class: 1 point</li>
<li>Reading the input file and writing output files: 2 points</li>
<li>Sorting alphabetically, by population, and by latitude (include all 3 output files): 3 points</li>
<li>Dynamic visualation of 50 most populous cities: 7 points</li>
</ul>
<p>Style: 7 points</p>
<ul>
<li>Clear design and organization: 4 points</li>
<li>Good variable names, function names, and comments: 2 points</li>
<li>Correct use of instance variables: 1 point</li>
</ul>
<h2 id="extra-credit-ideas">Extra credit ideas</h2>
<p>Any extra credit work should be submitted in separate Python files. Don't add extra credit work into your main solution code. These are just a few ideas; you are more than welcome to make up your own.</p>
<ul>
<li><p><strong>Randomized quicksort:</strong> 5 points.</p>
<p>The description I gave of how to partition always chooses the last item in the sublist, <code>the_list[r]</code>, as the pivot. Suppose that your worst enemy is supplying the input to quicksort. He or she could arrange the list so that the pivots selected in <code>partition</code> are always either the largest or the smallest items in the subarray. That would elicit the worst-case <span class="math"><em>O</em>(<em>n</em><sup>2</sup>)</span> behavior of quicksort.</p>
<p>But you can foil your enemy by choosing a <em>random</em> item in the sublist as the pivot. And it's easy! In each call of <code>partition</code>, first select a random index in the range from <span class="math"><em>p</em></span> to <span class="math"><em>r</em></span>, inclusive, and swap the item at this index with the item in <code>the_list[r]</code>. Then do everything that <code>partition</code> normally does: select <code>the_list[r]</code> as the pivot, compare all the other items in the sublist with the pivot, etc.</p></li>
<li><p><strong>Other maps:</strong> Up to 20 points.</p>
<p>The map I used has a linear scale in both latitude and longitude. Many other ways of mapping the world have been devised. Find one that has a good image and use that to map latitude and longitude.</p></li>
<li><p><strong>Cool visualizations:</strong> Up to 30 points.</p>
<p>Come up with a cool way to visualize the cities. For example, my way of blinking each city in red, showing the name of the city, and then showing it in solid orange would be worth 10 points.</p>
<p>I also used boldface text when displaying the city names. I called the function <code>set_font_bold</code> from cs1lib. Don't forget that you can read about all the functions in cs1lib by going to the <a href="http://www.cs.dartmouth.edu/~cs1/software.html">Course software</a> link and clicking on &quot;<code>cs1lib</code> User's Guide.&quot;</p></li>
</ul>
<h2 id="what-to-turn-in">What to turn in</h2>
<p>For the final version, turn in the following:</p>
<ul>
<li>All of your Python code: quicksort.py, city.py (even though you turned in city.py in the checkpoint), sort_cities.py, visualize_cities.py, along with any other Python files you write.</li>
<li>The output files cities_alpha.txt, cities_population.txt, and cities_latitude.txt.</li>
<li>A screenshot of your visualization of the 50 largest cities once all 50 are displayed.</li>
<li>Any other images or files needed to demonstrate extra credit.</li>
</ul>
</body>
</html>
